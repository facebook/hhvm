{{!

  Copyright (c) Meta Platforms, Inc. and affiliates.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.

}}

{{!
  param_type - For params that are nontrivial, decorators will read them by
  const ref, Otherwise for trivially copyable params like int64_t we pass them
  by value.
}}
{{#let export partial param_type |param|}}
{{#pragma ignore-newlines}}
{{#if param.type.resolves_to_complex_return?}}{{!
}}const {{param.type.cpp_standard_type}}&
{{#else}}
{{param.type.cpp_standard_type}}
{{/if param.type.resolves_to_complex_return?}}
{{/let partial}}

{{!
  param_name_unused - Commented out param name.
}}
{{#let partial param_name_unused |param|}}
{{#pragma ignore-newlines}}
/*p_{{param.cpp_name}}*/
{{/let partial}}

{{!
  param_name - this one is used when the param name is actually used
}}
{{#let export partial param_name |param|}}
{{#pragma ignore-newlines}}
p_{{param.cpp_name}}
{{/let partial}}

{{!
  return_param_type - Decorators after_* methods have const-ref access to the method
  return type.
}}
{{#let export partial return_param_type |function|}}
{{#pragma ignore-newlines}}
{{#if function.return_type.void?}}
{{#else}}
{{#if function.return_type.resolves_to_complex_return?}}
const {{function.return_type.cpp_standard_type}}&
{{#else}}
{{function.return_type.cpp_standard_type}}
{{/if function.return_type.resolves_to_complex_return?}}
{{/if function.return_type.void?}}
{{/let partial}}

{{!
  after_params_unused - Decorators after_* methods have const-ref access
  to the method return type. If the return type is an interaction, we also have
  a const-ref access to the returned interaction
}}
{{#let export partial after_params_unused |function| captures |return_param_type|}}
{{#pragma ignore-newlines}}
{{#if function.creates_interaction?}}{{! For interactions we have a const-ref to the interaction and the return type if non-void}}
, const {{function.created_interaction}}If& /*interaction*/
{{#if function.return_type.void?}}
{{#else}}
, {{#partial return_param_type function=function}} /*result*/
{{/if function.return_type.void?}}
{{#else}}{{! Otherwise just const-ref access to the return type return type if non-void}}
{{#if function.return_type.void?}}
{{#else}}
, {{#partial return_param_type function=function}} /*result*/
{{/if function.return_type.void?}}
{{/if function.creates_interaction?}}
{{/let partial}}

{{!
  after_params - Decorators after_* methods have const-ref access
  to the method return type. If the return type is an interaction, we also have
  a const-ref access to the returned interaction. This one doesn't have the
  param commented out.
}}
{{#let export partial after_params |function| captures |return_param_type|}}
{{#pragma ignore-newlines}}
{{#if function.creates_interaction?}}{{! For interactions we have a const-ref to the interaction and the return type if non-void}}
, const {{function.created_interaction}}If& interaction
{{#if function.return_type.void?}}
{{#else}}
, {{#partial return_param_type function=function}} result
{{/if function.return_type.void?}}
{{#else}}{{! Otherwise just const-ref access to the return type return type if non-void}}
{{#if function.return_type.void?}}
{{#else}}
, {{#partial return_param_type function=function}} result
{{/if function.return_type.void?}}
{{/if function.creates_interaction?}}
{{/let partial}}

{{!
  before_invocation_args - args passed to the decorator before_* function
}}
{{#let export partial before_invocation_args |function|}}
{{#pragma ignore-newlines}}
{{#each function.params.fields as |param|}}
{{#if param.type.resolves_to_complex_return?}}
{{#if function.stack_arguments?}}
, args.uarg_{{param.cpp_name}}
{{#else}}
, *args.uarg_{{param.cpp_name}}
{{/if function.stack_arguments?}}
{{#else}}
, args.uarg_{{param.cpp_name}}
{{/if param.type.resolves_to_complex_return?}}
{{/each}}
{{/let partial}}
